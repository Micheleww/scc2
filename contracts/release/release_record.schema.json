{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "contracts/release/release_record.schema.json",
  "title": "SCC Release Record v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_version", "release_id", "created_at", "sources", "artifacts", "verification"],
  "properties": {
    "schema_version": { "const": "scc.release_record.v1" },
    "release_id": { "type": "string", "minLength": 1 },
    "created_at": { "type": "string", "minLength": 1 },
    "sources": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["task_id", "submit_json", "patch_diff"],
        "properties": {
          "task_id": { "type": "string", "minLength": 1 },
          "submit_json": { "type": "string", "minLength": 1 },
          "patch_diff": { "type": "string", "minLength": 1 },
          "pr_bundle": { "type": ["string", "null"] }
        }
      }
    },
    "artifacts": {
      "type": "object",
      "additionalProperties": false,
      "required": ["release_dir", "release_record_json"],
      "properties": {
        "release_dir": { "type": "string", "minLength": 1 },
        "release_record_json": { "type": "string", "minLength": 1 }
      }
    },
    "verification": {
      "type": "object",
      "additionalProperties": false,
      "required": ["strict_gates_passed"],
      "properties": {
        "strict_gates_passed": { "type": "boolean" },
        "notes": { "type": ["string", "null"] }
      }
    },
    "notes": { "type": ["string", "null"] }
  }
}

