{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "contracts/map/map_version.schema.json",
  "title": "SCC Map Version v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_version", "generated_at", "generator", "map_path", "link_report_path", "hash", "coverage", "stats"],
  "properties": {
    "schema_version": { "const": "scc.map_version.v1" },
    "generated_at": { "type": "string", "minLength": 1 },
    "valid_until": { "type": "string", "minLength": 1 },
    "generator": {
      "type": "object",
      "additionalProperties": false,
      "required": ["name", "version"],
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "version": { "type": "string", "minLength": 1 }
      }
    },
    "map_path": { "type": "string", "minLength": 1 },
    "link_report_path": { "type": "string", "minLength": 1 },
    "hash": { "type": "string", "pattern": "^sha256:[a-f0-9]{64}$" },
    "facts_hash": { "type": "string", "pattern": "^sha256:[a-f0-9]{64}$" },
    "coverage": {
      "type": "object",
      "additionalProperties": false,
      "required": ["roots", "excluded_globs"],
      "properties": {
        "roots": { "type": "array", "minItems": 1, "items": { "type": "string", "minLength": 1 } },
        "excluded_globs": { "type": "array", "items": { "type": "string", "minLength": 1 } }
      }
    },
    "stats": {
      "type": "object",
      "additionalProperties": false,
      "required": ["files_indexed", "modules", "entry_points", "key_symbols", "test_entry_points", "configs", "doc_refs"],
      "properties": {
        "files_indexed": { "type": "integer", "minimum": 0 },
        "modules": { "type": "integer", "minimum": 0 },
        "entry_points": { "type": "integer", "minimum": 0 },
        "key_symbols": { "type": "integer", "minimum": 0 },
        "test_entry_points": { "type": "integer", "minimum": 0 },
        "configs": { "type": "integer", "minimum": 0 },
        "doc_refs": { "type": "integer", "minimum": 0 }
      }
    }
  }
}
