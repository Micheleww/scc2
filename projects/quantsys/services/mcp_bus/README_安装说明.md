# MCP服务器安装说明

## 🚀 最简单的安装方法

### 方法1：使用批处理文件（推荐，最简单）

1. **找到文件**：`安装.bat`
2. **右键点击**该文件
3. **选择**"以管理员身份运行"
4. **等待**安装完成

就这么简单！

### 方法2：如果只需要快捷方式（不需要管理员）

1. **找到文件**：`仅创建快捷方式.bat`
2. **双击运行**（不需要管理员权限）
3. 这会创建桌面快捷方式，但不会设置开机自启动

## 📋 安装步骤详解

### 完整安装（推荐）

1. 找到 `安装.bat` 文件
2. 右键点击 → 选择"以管理员身份运行"
3. 等待安装完成
4. 安装完成后，双击桌面快捷方式启动服务器

### 仅创建快捷方式

如果不需要开机自启动，可以：

1. 找到 `仅创建快捷方式.bat` 文件
2. 双击运行（不需要管理员权限）
3. 完成后，双击桌面快捷方式启动服务器

## ⚠️ 常见问题

### 问题1：右键没有"以管理员身份运行"选项

**解决方法：**
1. 按住 `Shift` 键
2. 右键点击 `安装.bat`
3. 选择"以管理员身份运行"

或者：

1. 按 `Win + X` 键
2. 选择"Windows PowerShell (管理员)"
3. 执行：
   ```powershell
   cd d:\quantsys\tools\mcp_bus
   .\安装.bat
   ```

### 问题2：出现"不是内部或外部命令"错误

**原因：** 可能是编码问题或PowerShell执行策略问题

**解决方法：**
1. 使用 `安装.bat`（已修复编码问题）
2. 或者手动执行：
   ```powershell
   # 以管理员身份打开PowerShell
   cd d:\quantsys\tools\mcp_bus
   Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process
   .\install_all.ps1
   ```

### 问题3：安装后找不到桌面快捷方式

**检查位置：**
- 桌面文件夹：`C:\Users\你的用户名\Desktop`
- 或者查看"安装完成说明.txt"中的路径

**重新创建：**
运行 `仅创建快捷方式.bat`

## 📁 文件说明

| 文件 | 说明 | 需要管理员 |
|------|------|-----------|
| `安装.bat` | 完整安装（推荐） | ✅ 是 |
| `仅创建快捷方式.bat` | 仅创建快捷方式 | ❌ 否 |
| `install_all.ps1` | PowerShell安装脚本 | ✅ 是 |
| `create_desktop_shortcut_tray.ps1` | 创建快捷方式脚本 | ❌ 否 |
| `setup_autostart_tray.ps1` | 设置自启动脚本 | ✅ 是 |

## 🎯 安装后使用

1. **启动服务器**：双击桌面快捷方式 `MCP服务器（托盘图标）.lnk`
2. **查看状态**：查看系统托盘（右下角）的图标颜色
3. **访问功能**：右键点击托盘图标 → 选择功能
4. **停止服务器**：右键点击托盘图标 → 选择"退出"

## 🎨 托盘图标颜色

- 🟢 **绿色**：服务器正常运行
- 🟡 **黄色**：部分服务异常
- 🔴 **红色**：服务器无法访问
- ⚪ **灰色**：启动中或状态未知

## 📞 需要帮助？

如果遇到问题，请查看：
- `README_TRAY.md` - 详细使用指南
- `TRAY_SETUP_GUIDE.md` - 设置指南
- `安装说明.txt` - 快速参考
